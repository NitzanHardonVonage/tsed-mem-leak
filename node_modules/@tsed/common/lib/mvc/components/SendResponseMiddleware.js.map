{"version":3,"file":"SendResponseMiddleware.js","sourceRoot":"","sources":["../../../src/mvc/components/SendResponseMiddleware.ts"],"names":[],"mappings":";;;AAAA,qCAAmE;AACnE,iDAAkD;AAClD,8CAAmD;AAGnD;;;GAGG;AAEH,IAAa,sBAAsB,GAAnC,MAAa,sBAAsB;IACjC,YAAsB,gBAAkC;QAAlC,qBAAgB,GAAhB,gBAAgB,CAAkB;IAAG,CAAC;IAErD,GAAG,CAAQ,GAAQ,EAAS,QAAa;QAC9C,MAAM,EAAC,IAAI,EAAE,QAAQ,EAAC,GAAG,GAAG,CAAC,GAAG,CAAC;QACjC,IAAI,IAAI,KAAK,SAAS,EAAE;YACtB,OAAO,QAAQ,CAAC,IAAI,EAAE,CAAC;SACxB;QAED,IAAI,eAAQ,CAAC,IAAI,CAAC,EAAE;YAClB,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;YAEpB,OAAO,QAAQ,CAAC;SACjB;QAED,IAAI,gBAAS,CAAC,IAAI,CAAC,IAAI,eAAQ,CAAC,IAAI,CAAC,IAAI,eAAQ,CAAC,IAAI,CAAC,IAAI,IAAI,KAAK,IAAI,EAAE;YACxE,OAAO,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;SAC5B;QAED,OAAO,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,gBAAgB,CAAC,SAAS,CAAC,IAAI,EAAE,EAAC,IAAI,EAAE,QAAQ,CAAC,IAAI,EAAC,CAAC,CAAC,CAAC;IACrF,CAAC;CACF,CAAA;AAlBC;IAAY,mBAAA,gBAAG,EAAE,CAAA,EAAY,mBAAA,gBAAG,EAAE,CAAA;;;;iDAiBjC;AApBU,sBAAsB;IADlC,uBAAU,EAAE;6CAE6B,6BAAgB;GAD7C,sBAAsB,CAqBlC;AArBY,wDAAsB","sourcesContent":["import {isBoolean, isNumber, isStream, isString} from \"@tsed/core\";\nimport {ConverterService} from \"../../converters\";\nimport {Middleware, Req, Res} from \"../decorators\";\nimport {IMiddleware} from \"../interfaces/index\";\n\n/**\n * See example to override SendResponseMiddleware [here](/docs/middlewares/override/send-response.md).\n * @middleware\n */\n@Middleware()\nexport class SendResponseMiddleware implements IMiddleware {\n  constructor(protected converterService: ConverterService) {}\n\n  public use(@Req() req: Req, @Res() response: Res) {\n    const {data, endpoint} = req.ctx;\n    if (data === undefined) {\n      return response.send();\n    }\n\n    if (isStream(data)) {\n      data.pipe(response);\n\n      return response;\n    }\n\n    if (isBoolean(data) || isNumber(data) || isString(data) || data === null) {\n      return response.send(data);\n    }\n\n    return response.json(this.converterService.serialize(data, {type: endpoint.type}));\n  }\n}\n"]}